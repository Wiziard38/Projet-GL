; start main program
; Class declaration
; Class object
	LOAD #null, R1
	PUSH R1
	LOAD object.equals, R2
	PUSH R2

; class A
	LEA 1(GB), R2
	PUSH R2
	LOAD object.equals, R2
	STORE R2, 1(SP)
	LOAD A.getX, R2
	STORE R2, 2(SP)
	LOAD A.setX, R2
	STORE R2, 3(SP)
	ADDSP #3

; Main program
; A a = new A();
	TSTO #1
	NEW #2, R2
	LEA 3(GB), R3
	STORE R3, 0(R2)
	PUSH R2
	BSR init.A
	POP R2
	PUSH R2
; 
; Beginning of main instructions:
	LOAD 7(GB), R2
	PUSH R2
	LOAD 0(R2), R2
	BSR 3(R2)
	SUBSP #1
	LOAD R0, R2
; 
	WSTR "x ="
	LOAD 7(GB), R2
	PUSH R2
	LOAD 0(R2), R2
	BSR 2(R2)
	SUBSP #1
	LOAD R0, R2
	LOAD R2, R1
	WINT
; 
; End of the main program
	HALT
; 
; Method declaration
object.equals:
	PUSH R3
	PUSH R2
	LOAD -2(LB), R2
	LOAD -3(LB), R3
	CMP R2, R3
	SEQ R0
	POP R2
	POP R3
	RTS
; 
init.A:
	TSTO #0
	PUSH R4
	PUSH R3
	PUSH R2
	LOAD #0, R2
	LOAD -2(LB), R3
	STORE R2, 1(R3)
	POP R2
	POP R3
	POP R4
	RTS
; 
A.getX:
	PUSH R2
	TSTO #0
	LOAD -2(LB), R2
	LOAD 1(R2), R2
	LOAD R2, R0
; 
	POP R2
A.setX:
	PUSH R4
	PUSH R3
	PUSH R2
	TSTO #0
	LOAD #5, R2
	LOAD -2(LB), R3
	LOAD 1(R3), R3
	LOAD -2(LB), R4
	STORE R2, 1(R4)
; 
	POP R2
	POP R3
	POP R4
	RTS
; 
ErreurPile:
	WSTR "Erreur de débordement de pile dans le programme"
	WNL
	ERROR
; 
overflof_error:
	WSTR "Erreur 'overflow' pendant une opération arithmétique"
	WNL
	ERROR
; 
io_error:
	WSTR "Erreur lors d'une entrée/sortie"
	WNL
	ERROR
; 
ErreurArrondi:
	WSTR "Erreur lors d'une opération arithmétique sur des flottant, arrondi vers 0 ou l'infini"
	WNL
	ERROR
; 
; end main program
